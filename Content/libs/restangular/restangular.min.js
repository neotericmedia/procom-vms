(function(){var n=angular.module("restangular",[]);n.provider("Restangular",function(){var n={},t;n.init=function(n,t){function e(n,t,i,r){var u={};return _.each(_.keys(r),function(f){var e=r[f];e.params=_.extend({},e.params,n.defaultRequestParams[e.method.toLowerCase()]),_.isEmpty(e.params)&&delete e.params,u[f]=n.isSafe(e.method)?function(){return t(_.extend(e,{url:i}))}:function(n){return t(_.extend(e,{url:i,data:n}))}}),u}var u,f,r,i;n.configuration=t,u=["get","head","options","trace","getlist"],t.isSafe=function(n){return _.contains(u,n.toLowerCase())},f=/^https?:\/\//i,t.isAbsoluteUrl=function(n){return _.isUndefined(t.absoluteUrl)||_.isNull(t.absoluteUrl)?n&&f.test(n):t.absoluteUrl},t.absoluteUrl=_.isUndefined(t.absoluteUrl)?!1:!0,n.setSelfLinkAbsoluteUrl=function(n){t.absoluteUrl=n},t.baseUrl=_.isUndefined(t.baseUrl)?"":t.baseUrl,n.setBaseUrl=function(n){return t.baseUrl=/\/$/.test(n)?n.substring(0,n.length-1):n,this},t.extraFields=t.extraFields||[],n.setExtraFields=function(n){return t.extraFields=n,this},t.defaultHttpFields=t.defaultHttpFields||{},n.setDefaultHttpFields=function(n){return t.defaultHttpFields=n,this},t.withHttpValues=function(n,i){return _.defaults(i,n,t.defaultHttpFields)},t.encodeIds=_.isUndefined(t.encodeIds)?!0:t.encodeIds,n.setEncodeIds=function(n){t.encodeIds=n},t.defaultRequestParams=t.defaultRequestParams||{get:{},post:{},put:{},remove:{},common:{}},n.setDefaultRequestParams=function(n,i){var r=[],u=i||n;return _.isUndefined(i)?r.push("common"):_.isArray(n)?r=n:r.push(n),_.each(r,function(n){t.defaultRequestParams[n]=u}),this},n.requestParams=t.defaultRequestParams,t.defaultHeaders=t.defaultHeaders||{},n.setDefaultHeaders=function(i){return t.defaultHeaders=i,n.defaultHeaders=t.defaultHeaders,this},n.defaultHeaders=t.defaultHeaders,t.methodOverriders=t.methodOverriders||[],n.setMethodOverriders=function(n){var i=_.extend([],n);return t.isOverridenMethod("delete",i)&&i.push("remove"),t.methodOverriders=i,this},t.jsonp=_.isUndefined(t.jsonp)?!1:t.jsonp,n.setJsonp=function(n){t.jsonp=n},t.isOverridenMethod=function(n,i){var r=i||t.methodOverriders;return!_.isUndefined(_.find(r,function(t){return t.toLowerCase()===n.toLowerCase()}))},t.urlCreator=t.urlCreator||"path",n.setUrlCreator=function(n){if(!_.has(t.urlCreatorFactory,n))throw new Error("URL Path selected isn't valid");return t.urlCreator=n,this},t.restangularFields=t.restangularFields||{id:"id",route:"route",parentResource:"parentResource",restangularCollection:"restangularCollection",cannonicalId:"__cannonicalId",etag:"restangularEtag",selfLink:"href",get:"get",getList:"getList",put:"put",post:"post",remove:"remove",head:"head",trace:"trace",options:"options",patch:"patch",getRestangularUrl:"getRestangularUrl",getRequestedUrl:"getRequestedUrl",putElement:"putElement",addRestangularMethod:"addRestangularMethod",getParentList:"getParentList",clone:"clone",ids:"ids",httpConfig:"_$httpConfig",reqParams:"reqParams",one:"one",all:"all",several:"several",oneUrl:"oneUrl",allUrl:"allUrl",customPUT:"customPUT",customPOST:"customPOST",customDELETE:"customDELETE",customGET:"customGET",customGETLIST:"customGETLIST",customOperation:"customOperation",doPUT:"doPUT",doPOST:"doPOST",doDELETE:"doDELETE",doGET:"doGET",doGETLIST:"doGETLIST",fromServer:"$fromServer",withConfig:"withConfig",withHttpConfig:"withHttpConfig"},n.setRestangularFields=function(n){return t.restangularFields=_.extend(t.restangularFields,n),this},t.isRestangularized=function(n){return!!n[t.restangularFields.one]||!!n[t.restangularFields.all]},t.setFieldToElem=function(n,t,i){var u=n.split("."),r=t;return _.each(_.initial(u),function(n){r[n]={},r=r[n]}),r[_.last(u)]=i,this},t.getFieldFromElem=function(n,t){var r=n.split("."),i=t;return _.each(r,function(n){i&&(i=i[n])}),angular.copy(i)},t.setIdToElem=function(n,i){return t.setFieldToElem(t.restangularFields.id,n,i),this},t.getIdFromElem=function(n){return t.getFieldFromElem(t.restangularFields.id,n)},t.isValidId=function(n){return""!==n&&!_.isUndefined(n)&&!_.isNull(n)},t.setUrlToElem=function(n,i){return t.setFieldToElem(t.restangularFields.selfLink,n,i),this},t.getUrlFromElem=function(n){return t.getFieldFromElem(t.restangularFields.selfLink,n)},t.useCannonicalId=_.isUndefined(t.useCannonicalId)?!1:t.useCannonicalId,n.setUseCannonicalId=function(n){return t.useCannonicalId=n,this},t.getCannonicalIdFromElem=function(n){var i=n[t.restangularFields.cannonicalId];return t.isValidId(i)?i:t.getIdFromElem(n)},t.responseInterceptors=t.responseInterceptors||[],t.defaultResponseInterceptor=function(n){return n},t.responseExtractor=function(n,i,r,u,f,e){var s=angular.copy(t.responseInterceptors),o;return s.push(t.defaultResponseInterceptor),o=n,_.each(s,function(n){o=n(o,i,r,u,f,e)}),o},n.addResponseInterceptor=function(n){return t.responseInterceptors.push(n),this},n.setResponseInterceptor=n.addResponseInterceptor,n.setResponseExtractor=n.addResponseInterceptor,t.requestInterceptors=t.requestInterceptors||[],t.defaultInterceptor=function(n,t,i,r,u,f,e){return{element:n,headers:u,params:f,httpConfig:e}},t.fullRequestInterceptor=function(n,i,r,u,f,e,o){var s=angular.copy(t.requestInterceptors);return s.push(t.defaultInterceptor),_.reduce(s,function(t,s){return _.defaults(t,s(n,i,r,u,f,e,o))},{})},n.addRequestInterceptor=function(n){return t.requestInterceptors.push(function(t,i,r,u,f,e,o){return{headers:f,params:e,element:n(t,i,r,u),httpConfig:o}}),this},n.setRequestInterceptor=n.addRequestInterceptor,n.addFullRequestInterceptor=function(n){return t.requestInterceptors.push(n),this},n.setFullRequestInterceptor=n.addFullRequestInterceptor,t.errorInterceptor=t.errorInterceptor||function(){},n.setErrorInterceptor=function(n){return t.errorInterceptor=n,this},t.onBeforeElemRestangularized=t.onBeforeElemRestangularized||function(n){return n},n.setOnBeforeElemRestangularized=function(n){return t.onBeforeElemRestangularized=n,this},t.onElemRestangularized=t.onElemRestangularized||function(n){return n},n.setOnElemRestangularized=function(n){return t.onElemRestangularized=n,this},t.shouldSaveParent=t.shouldSaveParent||function(){return!0},n.setParentless=function(n){return _.isArray(n)?t.shouldSaveParent=function(t){return!_.contains(n,t)}:_.isBoolean(n)&&(t.shouldSaveParent=function(){return!n}),this},t.suffix=_.isUndefined(t.suffix)?null:t.suffix,n.setRequestSuffix=function(n){return t.suffix=n,this},t.transformers=t.transformers||{},n.addElementTransformer=function(n,i,r){var f=null,e=null,u;arguments.length===2?e=i:(e=r,f=i),u=t.transformers[n],u||(u=t.transformers[n]=[]),u.push(function(n,t){return _.isNull(f)||n==f?e(t):t})},n.extendCollection=function(t,i){return n.addElementTransformer(t,!0,i)},n.extendModel=function(t,i){return n.addElementTransformer(t,!1,i)},t.transformElem=function(n,i,r,u){if(!t.transformLocalElements&&!n[t.restangularFields.fromServer])return n;var e=t.transformers[r],f=n;e&&_.each(e,function(n){f=n(i,f)});return t.onElemRestangularized(f,i,r,u)},t.transformLocalElements=_.isUndefined(t.transformLocalElements)?!0:t.transformLocalElements,n.setTransformOnlyServerElements=function(n){t.transformLocalElements=!n},t.fullResponse=_.isUndefined(t.fullResponse)?!1:t.fullResponse,n.setFullResponse=function(n){return t.fullResponse=n,this},t.urlCreatorFactory={},r=function(){},r.prototype.setConfig=function(n){return this.config=n,this},r.prototype.parentsArray=function(n){for(var t=[];n;)t.push(n),n=n[this.config.restangularFields.parentResource];return t.reverse()},r.prototype.resource=function(n,i,r,u,f,o,s,h){var l=_.defaults(f||{},this.config.defaultRequestParams.common),c=_.defaults(u||{},this.config.defaultHeaders),a,v;return s&&(t.isSafe(h)?c["If-None-Match"]=s:c["If-Match"]=s),a=this.base(n),o&&(v="",/\/$/.test(a)||(v+="/"),v+=o,a+=v),this.config.suffix&&a.indexOf(this.config.suffix,a.length-this.config.suffix.length)===-1&&!this.config.getUrlFromElem(n)&&(a+=this.config.suffix),n[this.config.restangularFields.httpConfig]=undefined,e(this.config,i,a,{getList:this.config.withHttpValues(r,{method:"GET",params:l,headers:c}),get:this.config.withHttpValues(r,{method:"GET",params:l,headers:c}),jsonp:this.config.withHttpValues(r,{method:"jsonp",params:l,headers:c}),put:this.config.withHttpValues(r,{method:"PUT",params:l,headers:c}),post:this.config.withHttpValues(r,{method:"POST",params:l,headers:c}),remove:this.config.withHttpValues(r,{method:"DELETE",params:l,headers:c}),head:this.config.withHttpValues(r,{method:"HEAD",params:l,headers:c}),trace:this.config.withHttpValues(r,{method:"TRACE",params:l,headers:c}),options:this.config.withHttpValues(r,{method:"OPTIONS",params:l,headers:c}),patch:this.config.withHttpValues(r,{method:"PATCH",params:l,headers:c})})},i=function(){},i.prototype=new r,i.prototype.base=function(n){var i=this;return _.reduce(this.parentsArray(n),function(n,r){var u,f=i.config.getUrlFromElem(r),o,e;if(f){if(i.config.isAbsoluteUrl(f))return f;u=f}else u=r[i.config.restangularFields.route],r[i.config.restangularFields.restangularCollection]?(o=r[i.config.restangularFields.ids],o&&(u+="/"+o.join(","))):(e=i.config.useCannonicalId?i.config.getCannonicalIdFromElem(r):i.config.getIdFromElem(r),t.isValidId(e)&&(u+="/"+(i.config.encodeIds?encodeURIComponent(e):e)));return n.replace(/\/$/,"")+"/"+u},this.config.baseUrl)},i.prototype.fetchUrl=function(n,t){var i=this.base(n);return t&&(i+="/"+t),i},i.prototype.fetchRequestedUrl=function(n,i){function o(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(t);return i.sort()}function s(n,t,i){for(var u=o(n),r=0;r<u.length;r++)t.call(i,n[u[r]],u[r]);return u}function e(n,t){return encodeURIComponent(n).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}var r=this.fetchUrl(n,i),f=n[t.restangularFields.reqParams],u;return f?(u=[],s(f,function(n,t){n!=null&&n!=undefined&&(angular.isArray(n)||(n=[n]),angular.forEach(n,function(n){angular.isObject(n)&&(n=angular.toJson(n)),u.push(e(t)+"="+e(n))}))}),r+(this.config.suffix||"")+(r.indexOf("?")===-1?"?":"&")+u.join("&")):r},t.urlCreatorFactory.path=i},t={},n.init(this,t),this.$get=["$http","$q",function(i,r){function u(t){function w(n,i,r,u,f){if(i[t.restangularFields.route]=r,i[t.restangularFields.getRestangularUrl]=_.bind(e.fetchUrl,e,i),i[t.restangularFields.getRequestedUrl]=_.bind(e.fetchRequestedUrl,e,i),i[t.restangularFields.addRestangularMethod]=_.bind(bt,i),i[t.restangularFields.clone]=_.bind(p,i,i),i[t.restangularFields.reqParams]=_.isEmpty(u)?null:u,i[t.restangularFields.withHttpConfig]=_.bind(yt,i),i[t.restangularFields.one]=_.bind(b,i,i),i[t.restangularFields.all]=_.bind(k,i,i),i[t.restangularFields.several]=_.bind(d,i,i),i[t.restangularFields.oneUrl]=_.bind(g,i,i),i[t.restangularFields.allUrl]=_.bind(nt,i,i),i[t.restangularFields.fromServer]=!!f,n&&t.shouldSaveParent(r)){var s=t.getIdFromElem(n),h=t.getUrlFromElem(n),c=_.union(_.values(_.pick(t.restangularFields,["route","parentResource"])),t.extraFields),o=_.pick(n,c);t.isValidId(s)&&t.setIdToElem(o,s),t.isValidId(h)&&t.setUrlToElem(o,h),i[t.restangularFields.parentResource]=o}else i[t.restangularFields.parentResource]=null;return i}function b(n,i,r){var f,u;if(_.isNumber(i)||_.isNumber(n)){f="You're creating a Restangular entity with the number instead of the route or the parent. You can't call .one(12)";throw new Error(f);}return u={},t.setIdToElem(u,r),o(n,u,i,!1)}function k(n,t){return c(n,[],t,!1)}function d(n,i){var r=[];return r[t.restangularFields.ids]=Array.prototype.splice.call(arguments,2),c(n,r,i,!1)}function g(n,i,r){if(!i)throw new Error("Route is mandatory when creating new Restangular objects.");var u={};return t.setUrlToElem(u,r),o(n,u,i,!1)}function nt(n,i,r){if(!i)throw new Error("Route is mandatory when creating new Restangular objects.");var u={};return t.setUrlToElem(u,r),c(n,u,i,!1)}function l(n,i,r){return n.call=_.bind(tt,n),n.get=_.bind(ct,n),n[t.restangularFields.restangularCollection]=i,i&&(n.push=_.bind(tt,n,"push")),n.$object=r,n}function tt(n){var i=r.defer(),f=arguments,u={};return this.then(function(t){var r=Array.prototype.slice.call(f,1),e=t[n];e.apply(t,r),u=t,i.resolve(t)}),l(i.promise,this[t.restangularFields.restangularCollection],u)}function ct(n){var u=r.defer(),i={};return this.then(function(t){i=t[n],u.resolve(i)}),l(u.promise,this[t.restangularFields.restangularCollection],i)}function h(n,i,r,u){if(_.extend(u,r),t.fullResponse)return n.resolve(_.extend(i,{data:r}));n.resolve(r)}function y(n){if(_.isArray(n)){var i=[];return _.each(n,function(n){i.push(y(n))}),i}return _.omit(n,_.values(_.omit(t.restangularFields,"id")))}function it(n){n[t.restangularFields.customOperation]=_.bind(v,n),_.each(["put","post","get","delete"],function(t){_.each(["do","custom"],function(i){var r=t==="delete"?"remove":t,f=i+t.toUpperCase(),u;u=r!=="put"&&r!=="post"?v:function(n,t,i,r,u){return _.bind(v,this)(n,i,r,u,t)},n[f]=_.bind(u,n,r)})}),n[t.restangularFields.customGETLIST]=_.bind(a,n),n[t.restangularFields.doGETLIST]=n[t.restangularFields.customGETLIST]}function p(n){var i=angular.copy(n);return o(i[t.restangularFields.parentResource],i,i[t.restangularFields.route],!0)}function o(n,i,r,u,e,o){var h=t.onBeforeElemRestangularized(i,!1,r),s=w(n,h,r,o,u);return t.useCannonicalId&&(s[t.restangularFields.cannonicalId]=t.getIdFromElem(s)),e&&(s[t.restangularFields.getParentList]=function(){return e}),s[t.restangularFields.restangularCollection]=!1,s[t.restangularFields.get]=_.bind(pt,s),s[t.restangularFields.getList]=_.bind(a,s),s[t.restangularFields.put]=_.bind(wt,s),s[t.restangularFields.post]=_.bind(ft,s),s[t.restangularFields.remove]=_.bind(ut,s),s[t.restangularFields.head]=_.bind(et,s),s[t.restangularFields.trace]=_.bind(ot,s),s[t.restangularFields.options]=_.bind(st,s),s[t.restangularFields.patch]=_.bind(ht,s),it(s),t.transformElem(s,!1,r,f)}function c(n,i,r,u,e){var s=t.onBeforeElemRestangularized(i,!0,r),o=w(n,s,r,e,u);return o[t.restangularFields.restangularCollection]=!0,o[t.restangularFields.post]=_.bind(ft,o,null),o[t.restangularFields.remove]=_.bind(ut,o),o[t.restangularFields.head]=_.bind(et,o),o[t.restangularFields.trace]=_.bind(ot,o),o[t.restangularFields.putElement]=_.bind(vt,o),o[t.restangularFields.options]=_.bind(st,o),o[t.restangularFields.patch]=_.bind(ht,o),o[t.restangularFields.get]=_.bind(at,o),o[t.restangularFields.getList]=_.bind(a,o,null),it(o),t.transformElem(o,!0,r,f)}function lt(n,t,i){var r=c(n,t,i,!1);return _.each(r,function(t){o(n,t,i,!1)}),r}function at(n,t,i){return this.customGET(n.toString(),t,i)}function vt(n,i,u){var s=this,h=this[n],o=r.defer(),e=[];return e=t.transformElem(e,!0,whatFetched,f),h.put(i,u).then(function(t){var i=p(s);i[n]=t,e=i,o.resolve(i)},function(n){o.reject(n)}),l(o.promise,!0,e)}function rt(n,i,r,u,f,e){var o=t.responseExtractor(n,i,r,u,f,e),s=f.headers("ETag");return o&&s&&(o[t.restangularFields.etag]=s),o}function a(n,u,s){var a=this,v=r.defer(),p="getList",d=e.fetchUrl(this,n),w=n||a[t.restangularFields.route],b=t.fullRequestInterceptor(null,p,w,d,s||{},u||{},this[t.restangularFields.httpConfig]||{}),y=[],k;return y=t.transformElem(y,!0,w,f),k="getList",t.jsonp&&(k="jsonp"),e.resource(this,i,b.httpConfig,b.headers,b.params,n,this[t.restangularFields.etag],p)[k]().then(function(i){var e=i.data,f=i.config.params,r=rt(e,p,w,d,i,v),u;if(!_.isArray(r))throw new Error("Response for getList SHOULD be an array and not an object or something else");u=_.map(r,function(i){return a[t.restangularFields.restangularCollection]?o(a[t.restangularFields.parentResource],i,a[t.restangularFields.route],!0,r):o(a,i,n,!0,r)}),u=_.extend(r,u),a[t.restangularFields.restangularCollection]?h(v,i,c(a[t.restangularFields.parentResource],u,a[t.restangularFields.route],!0,f),y):h(v,i,c(a,u,n,!0,f),y)},function(n){n.status===304&&a[t.restangularFields.restangularCollection]?h(v,n,a,y):t.errorInterceptor(n,v)!==!1&&v.reject(n)}),l(v.promise,!0,y)}function yt(n){return this[t.restangularFields.httpConfig]=n,this}function s(n,u,s,c,a){var d=this,w=r.defer(),ot=s||{},nt=u||this[t.restangularFields.route],ft=e.fetchUrl(this,u),k=c||this,tt=k[t.restangularFields.etag]||(n!="post"?this[t.restangularFields.etag]:null),v,b;_.isObject(k)&&t.isRestangularized(k)&&(k=y(k)),v=t.fullRequestInterceptor(k,n,nt,ft,a||{},ot||{},this[t.restangularFields.httpConfig]||{}),b={},b=t.transformElem(b,!1,nt,f);var it=function(i){var e=i.data,f=i.config.params,r=rt(e,n,nt,ft,i,w);r?n!=="post"||d[t.restangularFields.restangularCollection]?h(w,i,o(d[t.restangularFields.parentResource],r,d[t.restangularFields.route],!0,null,f),b):h(w,i,o(d,r,u,!0,null,f),b):h(w,i,undefined,b)},ut=function(i){i.status===304&&t.isSafe(n)?h(w,i,d,b):t.errorInterceptor(i,w)!==!1&&w.reject(i)},p=n,g=_.extend({},v.headers),et=t.isOverridenMethod(n);return et?(p="post",g=_.extend(g,{"X-HTTP-Method-Override":n==="remove"?"DELETE":n})):t.jsonp&&p==="get"&&(p="jsonp"),t.isSafe(n)?et?e.resource(this,i,v.httpConfig,g,v.params,u,tt,p)[p]({}).then(it,ut):e.resource(this,i,v.httpConfig,g,v.params,u,tt,p)[p]().then(it,ut):e.resource(this,i,v.httpConfig,g,v.params,u,tt,p)[p](v.element).then(it,ut),l(w.promise,!1,b)}function pt(n,t){return _.bind(s,this)("get",undefined,n,undefined,t)}function ut(n,t){return _.bind(s,this)("remove",undefined,n,undefined,t)}function wt(n,t){return _.bind(s,this)("put",undefined,n,undefined,t)}function ft(n,t,i,r){return _.bind(s,this)("post",n,i,t,r)}function et(n,t){return _.bind(s,this)("head",undefined,n,undefined,t)}function ot(n,t){return _.bind(s,this)("trace",undefined,n,undefined,t)}function st(n,t){return _.bind(s,this)("options",undefined,n,undefined,t)}function ht(n,t,i){return _.bind(s,this)("patch",undefined,t,n,i)}function v(n,t,i,r,u){return _.bind(s,this)(n,t,i,u,r)}function bt(n,i,r,u,f,e){var s,o;s=i==="getList"?_.bind(a,this,r):_.bind(v,this,i,r),o=function(n,t,i){var r=_.defaults({params:n,headers:t,elem:i},{params:u,headers:f,elem:e});return s(r.params,r.headers,r.elem)},this[n]=t.isSafe(i)?o:function(n,t,i){return o(t,i,n)}}function kt(i){var r=angular.copy(_.omit(t,"configuration"));return n.init(r,r),i(r),u(r)}var f={},e=new t.urlCreatorFactory[t.urlCreator];return e.setConfig(t),n.init(f,t),f.copy=_.bind(p,f),f.withConfig=_.bind(kt,f),f.one=_.bind(b,f,null),f.all=_.bind(k,f,null),f.several=_.bind(d,f,null),f.oneUrl=_.bind(g,f,null),f.allUrl=_.bind(nt,f,null),f.stripRestangular=_.bind(y,f),f.restangularizeElement=_.bind(o,f),f.restangularizeCollection=_.bind(lt,f),f}return u(t)}]})})();
//@ sourceMappingURL=restangular.min.js.map